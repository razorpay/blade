import { Meta } from '@storybook/addon-docs';

<Meta title="Guides/Installation" />

# ‚öôÔ∏è Installation

<br />
<br />

## ‚úçüèª Pre-requisite

Before you install the package, make sure that you have performed the following steps:

- You must be running Node version >=14.19.0

<details>
<summary>Razorpay Employees have to point @razorpay scope to GitHub Package Registry. Follow the steps below</summary>

- Generate a Personal Access Token on GitHub by [visiting this link](https://github.com/settings/tokens/new?scopes=repo,workflow,write:packages,read:repo_hook,write:packages) (Enable SSO by clicking `Authorize` button next to Razorpay logo.)
- Run `code ~/.bashrc` or `code ~/.zshrc` in your editor and add this line

  ```
  export GITHUB_ACCESS_TOKEN="<YOUR_TO  KEN>"
  ```

  > **Note**
  >
  > Replace `<YOUR_TOKEN>` with your actual GitHub Personal Access Token

- Run `source ~/.bashrc` or `source ~/.zshrc` based on the file you added your token.
- Run `code ~/.npmrc` and append the following
  ```bash
  # add following to your .npmrc
  @razorpay:registry=https://npm.pkg.github.com/
  //npm.pkg.github.com/:always-auth=true
  //npm.pkg.github.com/:_authToken=${GITHUB_ACCESS_TOKEN}
  ```

</details>

## ‚¨á Add blade to your application

1. Install blade as a dependency.
   Blade has a peer dependency on a few libraries, you can skip adding it if you already have it installed in your project.

- `styled-components`
  > **Note**
  >
  > Currently, blade only supports styled-components v5 only
- `@floating-ui/react`

```shell
yarn add @razorpay/blade styled-components@5.3.11 @floating-ui/react
```

2. Follow [this guide](#-install-fonts) to install the fonts.

3. For **React Native** projects you need to do additional setup for the peer dependencies:

   - react-native-reanimated
     - Follow [this guide](https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/installation) to install it on Android & iOS which is required by Blade.
   - react-native-svg
     - Follow [this guide](https://github.com/react-native-svg/react-native-svg#with-react-native-cli) to install it on Android & iOS which is required by Blade.
   - react-native-gesture-handler
     - Follow [this guide](https://docs.swmansion.com/react-native-gesture-handler/docs/installation) to install it, note that you don't need to add `<GestureHandlerRootView style={{ flex: 1 }}>` again on the root because BladeProvider already adds that out of the box.
   - @gorhom/bottom-sheet
     - Add this as peer dependency, no need to do additional setup since BladeProvider already sets everything up.
   - @gorhom/portal
     - Add this as peer dependency, no need to do additional setup since BladeProvider already sets everything up.
   - @floating-ui/react-native
     - Add this as peer dependency, no need to do additional setup.

## üîú Add blade libraries to your Figma project

Coming Soon

## üî° Installing Fonts

We use 2 fonts. [Tasa Orbiter](https://tasatype.localremote.co/) (for our headings), and [Inter](https://rsms.me/inter/) (for other text elements).

### Web Projects

To add these fonts to your project, you can import them from blade package in your root entry file.

```ts
// Somewhere in root index.ts or entryBrowser.tsx file
import '@razorpay/blade/fonts.css';
```

While Blade handles setting font-family for its own components, you can set font-family globally as well in your global styles for any custom components or exceptions

```ts
import { createGlobalStyle } from 'styled-components';

const GlobalStyles = createGlobalStyle`
* { 
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: ${(props) => props.theme.typography.fonts.family.text}
}

h1, h2, h3, h4, h5, h6 {
  font-family: ${(props) => props.theme.typography.fonts.family.heading};
}
`;
```

### React Native Projects

- Download `Lato` font from [here](https://fonts.google.com/share?selection.family=Lato:ital,wght@0,400;0,700;1,400;1,700)
- Copy the font files and paste them under the directory `<project_root>/public/fonts`(**create the directory if it doesn't exist**)
- Create a React Native config file at the root of your project - `<project_root>/react-native.config.js` and add the following content to it

  ```js
  module.exports = {
    // ... rest of the config
    assets: ['./public/fonts/'],
  };
  ```

#### android

Follow the next steps mentioned below for configuring fonts to work on Android:

- Create a directory `font` under `/android/app/src/main/res/font`
- Copy the font files `Lato-Regular` and `Lato-Bold` you had downloaded earlier and paste them under `/android/app/src/main/res/font`
- Rename the font files (**mind the casing and underscores**):
  - ~~`Lato-Regular.ttf`~~ ‚û°Ô∏è `lato_regular.ttf`
  - ~~`Lato-RegularItalic.ttf`~~ ‚û°Ô∏è `lato_regular_italic.ttf`
  - ~~`Lato-Bold.ttf`~~ ‚û°Ô∏è`lato_bold.ttf`
  - ~~`Lato-BoldItalic.ttf`~~ ‚û°Ô∏è `lato_bold_italic.ttf`
- Create a file `lato.xml` under `/android/app/src/main/res/font/lato.xml` and copy the following contents to it
  ```xml
  <?xml version="1.0" encoding="utf-8"?>
    <font-family xmlns:app="http://schemas.android.com/apk/res-auto">
    <font app:fontStyle="normal" app:fontWeight="400" app:font="@font/lato_regular"/>
    <font app:fontStyle="normal" app:fontWeight="700" app:font="@font/lato_bold" />
    <font app:fontStyle="italic" app:fontWeight="400" app:font="@font/lato_regular_italic" />
    <font app:fontStyle="italic" app:fontWeight="700" app:font="@font/lato_bold_italic" />
  </font-family>
  ```
- Navigate to `/android/app/src/main/java/com/<your_package_name>/MainApplication.java` and add the following contents to it

  ```js
  // add the below import statement after all the import statements
  import com.facebook.react.views.text.ReactFontManager;
  ```

  Now search for `onCreate` method and add the following line to it

  ```js
  public void onCreate() {
    // add the below line as the first line
    ReactFontManager.getInstance().addCustomFont(this, "Lato", R.font.lato);
    // rest of the content of the method
  }
  ```

#### iOS

Follow the next steps mentioned below for configuring fonts to work on iOS:

- Once you've copied the font files under `<project_root>/public/fonts` you need to link it using the following command

  ```shell
  npx react-native link --platforms ios
  ```
